<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="format-detection" content="telephone=no">
  <meta name="format-detection" content="address=no">
  <meta name="applicable-device" content="mobile">
  <meta name="author" content="JackLu">
  <meta name="viewport" content="width=device-width, initial-scale=1.0 maximum-scale=1,minimum-scale=1,user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="screen-orientation" content="portrait">
  <meta name="description" content="一个记录我们在一起经过点点滴的idea">
  <meta name="theme-color" content="#f7d7da">
  <!-- 配置Open graph -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://jackluson.github.io/to-lover-demo/">
  <meta property="og:description" content="一个记录“我们在一起走过点点滴滴”的idea">
  <meta property="og:title" content="宝贝,感谢你一直的陪伴！">
  <meta property="og:image" content="https://jackluson.github.io/to-lover-demo/pic-icon.png">
  <meta property="og:image:width" content="140">
  <meta property="og:image:height" content="109">
  <title>宝贝,感谢你一直的陪伴！</title>
  <style>
    html,body,.snow{
    height: 100%;
    width: 100%;
    overflow: hidden;
    margin: 0;
  }
</style>
  <link rel="icon" href="./favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./css/index.css">
  <script type="text/javascript" src="./js/jquery.js"></script>
  <script type="text/javascript" src="./js/three.js"></script>
  <script src="./js/count-time.js"></script>

</head>

<body>
  <div class="music">
    <i class="iconfont music-close">&#xea28;</i>
    <!-- <audio class="audio" src="./media/dongxi-md.mp3" preload autoplay loop></audio>  -->
    <audio class="audio" preload autoplay loop>
      <source src="./media/zui-mei-qing-lv-cut.mp3" type="audio/mp3" /> Your browser does not support the audio element.</audio> 
  </div>
  <div class="banner ovh">
    <div class="swiper-wrap">
      <!-- <img src="./images/DSC_0692_mix01.jpg" alt=""> -->
      <!-- <img src="./img/20180319230435.jpg" alt=""> -->
      <img id="current-img" src="./images/adult-bicycle-bike-1878704.jpg" alt="">
      <p class="img-intro">让我们放飞梦想,扬帆起航</p>
    </div>
    <!-- <video class="video hide" webkit-playsinline="" playsinline="" x5-playsinline="" controls loop src=""></video> -->
  </div>
  <p class="intro self-design">the times we together</p>
  <p class="date self-design">
    <span id="day" class="time-font"></span>
    <span class="date-icon" style="color:#FF9999" data-text="days">/&nbsp;</span>
    <span id="hour" class="time-font"></span>
    <span class="date-icon" style="color:#FF9999" data-text="hours">/&nbsp;</span>
    <span id="minute" class="time-font"></span>
    <span class="date-icon" style="color:#FF9999" data-text="min">/&nbsp;</span>
    <span id="second" class="time-font"></span>
    <span class="date-icon" style="color:#FF9999" data-text="sec">/&nbsp;</span>
  </p>
  <p class="svg">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="9001302152" x="0px"
      y="0px" width="100%" height="100%" viewBox="0 0 141.4 69.4" style="enable-background:new 0 0 141.4 69.4;" xml:space="preserve"
      preserveAspectRatio="none" class="element svg-element">
      <g>
        <path style="fill:#FF3939;" d="M134.5,9c-3.9-3.9-8.2-5.4-13.4-3.2c-3.5,1.5-7.9,4.4-9.4,8.2c-3.8-7.9-11.4-13.9-20.5-13.2   c-9.2,0.6-16.2,7-19.1,15.3c-1.8-5.9-7.8-10.3-13.2-13c-7.7-3.8-17.3-4.6-24.7,0.5c-3.8,2.6-6.1,6.6-7.5,11   C25,11,22.2,7.5,18.5,5.9c-4.4-1.8-7.8,0.5-10.7,3.7C3.6,14.1-4.8,28.1,3.6,32.3c0.3,0.2,0.6,0.1,0.9,0c1,0.3,2.1,0.2,3.2-0.3   c1.2-0.6,2.3-1.8,3.2-3.2c2.6,1.2,5.8,0,7.5-2.2c1.4,0.8,3.4,0.6,4.8,0c0.5-0.2,1.1-0.6,1.7-1c-0.1,1.8,0,3.6,0.1,5.3   C25.4,41,29,50.7,36,58c14,14.7,38.9,13.3,56.5,6.3c8-3.2,14.4-8.4,17.8-16.5c2.6-6.4,4.4-13.8,4.2-21c1.9,1.9,5,2.3,7.3,0.9   c0.5,0.4,1,0.7,1.5,1c2.3,1,5,0.8,6.9-0.8c1.2,1,2.5,1.6,3.9,1.8c0,0.5,0.3,1,1,1C147.2,29.8,139,13.5,134.5,9z M25,22.6   c-0.8,0.7-1.5,1.5-2.6,2c-1,0.4-2.1,0.5-3.1,0.5c0.4-1.1,0.5-2.2,0.1-3.4c-0.2-0.6-1.1-0.7-1.3,0c-0.4,1.7-0.9,3.4-2.2,4.5   c-1.2,1-2.8,1.4-4.4,1.4c0.8-1.7,1.2-3.6,1-5.1c-0.1-0.7-1-1.1-1.4-0.4c-1.1,2.1-1.6,4.4-2.9,6.3c-0.6,0.9-1.5,1.9-2.7,2   c-0.4,0-0.9,0-1.4-0.2c-2.8-2.7-1.2-7.4,0-10.5c1.1-2.9,2.7-5.5,4.7-7.9c2.8-3.2,5.7-5,10.2-3c2.6,1.1,5.3,5.1,6.8,7.3   c0.1,0.1,0.1,0.2,0.2,0.2C25.6,18.4,25.2,20.5,25,22.6z M94,60.5c-13.3,6.3-33.5,8.7-46.9,2c-15.8-7.9-21.4-26.8-18.3-43.2   C30.7,8.9,38,1.6,49,2.7c9.2,0.9,22.4,8.6,21.7,19.1c0,0.8,1.2,1,1.5,0.4c0.6,0,1.1-0.2,1.3-1c2.1-8.5,7.9-16,17-17.2   C99.6,3,107,9.6,109.9,17.8C115.2,32.8,108.6,53.6,94,60.5z M136,28.1c-1.9-0.5-3.8-1.6-5.1-3.1c-1.5-1.7-2.1-4.1-3.8-5.5   c-0.5-0.4-1.2-0.1-1.2,0.5c0,2.1,1.3,4.6,2.8,6.4c-1.5,0.5-3.1,0.5-4.5-0.2c-1.8-1-2.2-2.8-3.2-4.4c-0.4-0.6-1.2-0.4-1.4,0.2   c-0.6,1.5-0.1,3.1,0.9,4.4c-1.9,0.1-3.9-0.9-5-2.5c-0.3-0.4-0.8-0.6-1.2-0.5c-0.3-2.6-0.9-5.2-1.9-7.7c0-0.1-0.1-0.1-0.1-0.2   c5-3.8,10.2-11.7,17.6-7.4C135.1,11.1,143.6,24,136,28.1z"></path>
        <path style="fill:#FF3939;" d="M43.1,46.1c-0.2-0.1-0.5-0.2-0.8-0.2c0.5-4.9-0.1-10.5-0.8-15.3c0.5,0,1-0.1,1.5-0.2   c0.9-0.2,0.9-1.6,0-1.8c-1.3-0.3-2.9-0.2-4.2,0c-0.9,0.1-0.9,1.7,0,1.8c0.3,0,0.5,0.1,0.8,0.1c-0.2,4.8-0.3,10.4,0.5,15.2   c-0.5,0-0.9,0.1-1.4,0.1c-1.1,0.2-0.9,2.1,0.3,2c1.2-0.1,2.2,0.1,3.4,0.3C43.8,48.3,44.3,46.6,43.1,46.1z"></path>
        <path style="fill:#FF3939;" d="M67.9,32.6c0.3-2.7-2-5.5-4.8-5.6c-1.5,0-2.9,0.6-3.9,1.7c-0.2,0.3-0.5,0.6-0.7,1   c-0.8-1.3-2.2-2.2-3.9-2.3c-2.2-0.1-5.1,1.6-5.2,4c-3.2,6.6-1,18.6,7.6,18.9C65.9,50.6,68.9,40,67.9,32.6z M57.4,48.3   c-4.5,0.1-7.1-4.6-7.4-8.5c-0.2-2.7,0.7-5.3,0.8-7.9c0.9-1.1,1.6-2.3,3.3-2.3c1.8-0.1,3.2,1.5,3.6,3.1c0.2,0.9,1.7,0.7,1.7-0.2   c0.1,0,0.1-0.1,0.2-0.1c0.6-0.5,0.5-1.2,0.9-1.9c0.5-0.8,1.5-1.3,2.5-1.3c2.2,0,3.1,2.5,3.3,4.3c0,0,0,0,0,0   C65.8,39.5,65.2,48.1,57.4,48.3z"></path>
        <path style="fill:#FF3939;" d="M77.8,27.5c-0.2,0-0.5,0.1-0.6,0.3c-0.4,0.8,0.1,1.7,0.1,2.6c0,1-0.6,2-1.6,2.3   c-2.6,0.8-2.8-2.5-3-4.2c-0.1-0.5-0.7-0.7-0.9-0.1c-0.6,1.5-0.9,3.4,0.1,4.9c0.7,1.1,1.9,1.7,3.2,1.7c-0.3,2.2-0.3,4.4-0.2,6.5   c0.1,2.2,0,4.7,1.1,6.7c0.4,0.6,1.3,0.5,1.5-0.2c0.6-2.2,0-4.8-0.2-7.1c-0.2-2.1-0.3-4.2-0.6-6.3c1.4-0.5,2.5-1.8,2.8-3.2   C79.7,30.2,79.5,27.6,77.8,27.5z"></path>
        <path style="fill:#FF3939;" d="M90.5,42.1c0-4.2,0.1-10.4-3.4-13.3c-0.2-0.2-0.5-0.2-0.7-0.2c-5.3-3.1-4.9,6.5-4.8,9   c0.2,3.2-0.4,12.9,5.3,11.3c0.4-0.1,0.6-0.4,0.6-0.7C90,47.9,90.5,44.4,90.5,42.1z M86.7,47.1C86.7,47.1,86.7,47.1,86.7,47.1   c-1.6,0-2.4-4-2.5-5.1c-0.1-1.2-0.2-2.4-0.3-3.7c-0.1-1.8-1.2-8.3,1.9-8.8c0,0.1,0.1,0.3,0.2,0.4C89.2,33.3,89.9,43.2,86.7,47.1z"></path>
        <path style="fill:#FF3939;" d="M100.8,34.7c-0.2-2.7-0.4-5.5-1.1-8c-0.3-0.9-1.6-0.7-1.6,0.2c0,1.8,2.3,18.2-0.9,17.6   c-0.2,0-0.4,0-0.6,0.1c-3-2.3-2.3-14.4-2.8-16.7c-0.1-0.6-0.9-0.5-1.1,0c-0.8,2.7-1.1,24,5.9,18.7c0.1-0.1,0.2-0.2,0.3-0.3   c1.3-0.5,2-1.8,2.3-3.5C101.4,40.2,101,37.3,100.8,34.7z"></path>
      </g>
    </svg>
  </p>
  <p class="our-name self-design">Lu <span>&</span> Deng</p>
  <script type="text/javascript">
    //设置起始日期
    countTime('2017/02/12 00:00', 'day', 'hour', 'minute', 'second');
    var days = parseInt($('#day').text());
    var years = new Date().getFullYear();
    var month = new Date().getMonth() + 1;
    var dateDay = new Date().getDate();
    // 设置标题
    if (month == 2 && dateDay == 12) {
      $(document).attr("title", "在一起" + parseInt(years - 2017) + "年,始于初见,终于到老。");
    } else if (dateDay == 12) {
      $(document).attr("title", "在一起" + parseInt(days / 30) + "个月,始于初见,终于到老。");
    } else
    $(document).attr("title", "在一起" + days + "天,始于初见,终于到老。");
    document.writeln(
      "<div class=\"snow\" style=\"height:100%; position:fixed; left:0px; top:0px;right:0px; bottom:0px; pointer-events: none;z-index: 9999;\"><canvas width=\"1904\" height=\"913\" style=\"position:absolute;left: 0;top: 0;\"></canvas></div>"
    );

    $(function () {

      if (/MSIE 6|MSIE 7|MSIE 8/.test(navigator.userAgent)) {
        return
      }
      var container = document.querySelector(".snow");
      // IE9-10 pointer-events兼容
      if (/MSIE 9|MSIE 10/.test(navigator.userAgent)) {
        $(container).bind('click mousemove', function (evt) {
          this.style.display = 'none';
          var x = evt.pageX,
            y = evt.pageY
          if ($(document).scrollTop() > 0 || $(document).scrollTop() > 0) {
            x = x - $(document).scrollLeft() + 1
            y = y - $(document).scrollTop() + 1
          }
          evt.preventDefault();
          evt.stopPropagation();
          var under = document.elementFromPoint(x, y);
          var evtType = evt.type === 'click' ? 'click' : 'mouseenter'
          if (evt.type === 'click') {
            $(under)[0].click();
          } else {
            $(under).trigger('mouseenter');
          }
          $('body').css('cursor', 'default')
          this.style.display = '';
          return false;
        });
      }
      var containerWidth = $(container).width();
      var containerHeight = $(container).height();
      var particle;
      var camera;
      var scene;
      var renderer;
      var mouseX = 0;
      var mouseY = 0;
      var windowHalfX = window.innerWidth / 2;
      var windowHalfY = window.innerHeight / 2;
      var particles = [];
      var particleImages = [new Image(), new Image(), new Image(), new Image(), new Image()];
      // particleImages[0].src = "./images/snow1.png";
      // particleImages[1].src = "./images/snow2.png";
      // particleImages[2].src = "./images/snow3.png";
      // particleImages[3].src = "./images/snow4.png";
      // particleImages[4].src = "./images/snow5.png";
      particleImages[0].src = "./img/151375665240370100.png";
      particleImages[1].src = "./img/151375668550091372.png";
      particleImages[2].src = "./img/151375669416355455.png";
      particleImages[3].src = "./img/151375670204115466.png";
      particleImages[4].src = "./img/151375671039447316.png";
      var snowNum = 300;

      function init() {
        camera = new THREE.PerspectiveCamera(75, containerWidth / containerHeight, 1, 10000);
        camera.position.z = 1000;
        scene = new THREE.Scene();
        scene.add(camera);
        renderer = new THREE.CanvasRenderer();
        renderer.setSize(containerWidth, containerHeight);
        for (var i = 0; i < snowNum; i++) {
          var material = new THREE.ParticleBasicMaterial({
            map: new THREE.Texture(particleImages[i % 5])
          });
          particle = new Particle3D(material);
          particle.position.x = Math.random() * 2000 - 1000;
          particle.position.y = Math.random() * 2000 - 1000;
          particle.position.z = Math.random() * 2000 - 1000;
          particle.scale.x = particle.scale.y = 1;
          scene.add(particle);
          particles.push(particle)
        }
        container.appendChild(renderer.domElement);
        document.addEventListener("mousemove", onDocumentMouseMove, false);
        document.addEventListener("touchstart", onDocumentTouchStart, false);
        document.addEventListener("touchmove", onDocumentTouchMove, false);
        setInterval(loop, 1000 / 50)
      }

      function onDocumentMouseMove(event) {
        mouseX = event.clientX - windowHalfX;
        mouseY = event.clientY - windowHalfY
      }

      function onDocumentTouchStart(event) {
        if (event.touches.length === 1) {
          event.preventDefault();
          mouseX = event.touches[0].pageX - windowHalfX;
          mouseY = event.touches[0].pageY - windowHalfY
        }
        event.preventDefault();
      }

      function onDocumentTouchMove(event) {
        if (event.touches.length === 1) {
          event.preventDefault();
          mouseX = event.touches[0].pageX - windowHalfX;
          mouseY = event.touches[0].pageY - windowHalfY
        }
        event.preventDefault();
      }

      function loop() {
        for (var i = 0; i < particles.length; i++) {
          var particle = particles[i];
          // 滚动到楼层模块，减少雪花 （自定义）
          if ($(window).scrollTop() < 1000) {
            particle.scale.x = particle.scale.y = 1;
          } else {
            if (i > particles.length / 5 * 3) {
              particle.scale.x = particle.scale.y = 0;
            } else {
              particle.scale.x = particle.scale.y = 0.8;
            }
          }
          particle.updatePhysics();
          with(particle.position) {
            if (y < -1000) {
              y += 2000
            }
            if (x > 1000) {
              x -= 2000
            } else {
              if (x < -1000) {
                x += 2000
              }
            }
            if (z > 1000) {
              z -= 2000
            } else {
              if (z < -1000) {
                z += 2000
              }
            }
          }
        }
        camera.position.x += (mouseX - camera.position.x) * 0.005;
        camera.position.y += (-mouseY - camera.position.y) * 0.005;
        camera.lookAt(scene.position);
        renderer.render(scene, camera)
      }
      init()
    });
  </script>
</body>
<script>
  var musicDom = document.querySelector('.music');
  // var bannerDom = document.querySelector('.banner');
  var audioDom = document.querySelector('.audio');
  // var videoDom = document.querySelector('.video');
  // var swiperWrapDom = document.querySelector('.swiper-wrap');
  // var playVideo = document.querySelector('.our-name');
  var musicCloseDom = musicDom.querySelector('.music-close');
  var curImgDom = document.getElementById('current-img');
  if ( audioDom.readyState == 4) { // android会走此逻辑
      // @todo
      console.log('loaded');
  } else { // iOS走此逻辑
      audioDom.addEventListener('play', function () {
          try {
              musicCloseDom.classList.add('rotate');
          } catch (error) {
              // console.log('error', error);
          }
      }, false);
      audioDom.addEventListener('canplaythrough', function () {
          try {
              // chrome浏览器没有也页面交互（点击，滚动）之前会报错误---Uncaught（in promise）DOMException：play（）
              //处理方法设置浏览器autoplay-policy---https://blog.csdn.net/super_XYQ/article/details/83026792
              var promise = audioDom.play();
              if (promise !== undefined) {
                  promise.then(function () {
                      musicCloseDom.classList.add('rotate');
                  }).catch(function () {
                      musicCloseDom.classList.remove('rotate');
                  });
              }
          } catch (error) {
              console.log('error', error);
          }
      }, false);
      audioDom.load();
  }

  musicDom.addEventListener('click', function (event) {
      if (!audioDom.paused) {
          audioDom.pause();
          musicCloseDom.classList.remove('rotate');
      } else {
          audioDom.play();
          musicCloseDom.classList.add('rotate');
      }

      event.preventDefault();
  }, false);

  function loadImage(imgIndex) {
      // console.log('imgIndex:',imgIndex);
      // var img = new Image();
      curImgDom.src = imgList[imgIndex];
      // curImgDom.setAttribute('src', imgList[imgIndex]);
      if (isInitImage) {
          $('.img-intro').text(imgDescList[imgIndex]);
          return;
      }else {
          // curImgDom.src = imgList[imgIndex];
          if (curImgDom.complete) {
              $('.img-intro').text(imgDescList[imgIndex]);
              return false;
          }
          curImgDom.onload = function () {
              $('.img-intro').text(imgDescList[imgIndex]);
          };
      }
      
  }
  var imgList = ['./images/adult-bicycle-bike-1878704.jpg', './images/alone-boulders-idyllic-426893.jpg', './images/back-view-blur-carefree-1892512.jpg', './images/balance-clothes-colors-1882003.jpg', './images/bowl-cooking-cuisine-1640773.jpg', './images/camera-lens-clouds-hand-1208074.jpg', './images/louie-castro-garcia-1355308-unsplash.jpg'];
  var imgDescList = ['让我们携手放飞梦想,扬帆起航','想不到被我拍到了吧，最喜欢下班后吃到香喷喷的饭菜了。','TIT创意园,这够不够创意啦!<br>!','名师出高徒可不是闹着玩的。','第一次用抖音拍照，效果不赖吧！','宝贝,祝你在新的一年里红红火火，行大运！','七色彩圈,印证我们走过的点点滴滴'];
  var isInitImage = false; //循环图片列表之后改了true,取消onload事件;
  var imgIndex = 0;
  function setTimer(){
      var timer = setInterval(function() {
          imgIndex = 1 + imgIndex;
          if (imgIndex > (imgList.length - 1)) {
              imgIndex = 0;
              if (!isInitImage) {
                  isInitImage = true;
                  curImgDom.onload = null;
              }
          }
          imgIndex = (imgIndex > (imgList.length - 1)) ? 0 : imgIndex;
          loadImage(imgIndex);
      }, 3000);
      return timer;
  }
  var timer= setTimer();
</script>

</html>